<template>
    <div class="bookmarklets-view">
      <h1 class="text-xl font-bold mb-4">Bookmarklets</h1>
      <p>Bookmarklets are browser bookmarks that execute JavaScript (code) instead of opening a webpage. They can do some pretty cool things with the website you are on, as you will see below.</p>
      <p>Drag the bookmarklet buttons to your bookmarks bar, and click them on the website you want to use them on.</p>
      <p>You can click the buttons below to test it out on this site!</p>
      <br>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <div v-for="bookmarklet in bookmarklets" :key="bookmarklet.name" class="p-4 border rounded-lg shadow">
          <h2 class="text-lg font-semibold">{{ bookmarklet.name }}</h2>
          <p class="text-sm text-gray-600">{{ bookmarklet.description }}</p>
          <a 
            class="mt-2 inline-block bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600"
            :href="bookmarklet.code"
            :draggable="true"
            @dragstart="(event) => onDragStart(event, bookmarklet.code)"
          >{{ bookmarklet.name }}</a>
        </div>
      </div>
    </div>
  </template>
  
  <script>
  export default {
    data() {
      return {
        bookmarklets: [
          {
            name: 'Tab Cloak',
            description: 'Disguise any website you\'re on as Canvas, Desmos, or Google Drive!',
            code: "javascript:(function () {var a = document.createElement('script');a.src = 'data:text/javascript;base64,dmFyIGw9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcigibGlua1tyZWwqPSdpY29uJ10iKXx8ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGluayIpO2wudHlwZT0iaW1hZ2UveC1pY29uIixsLnJlbD0ic2hvcnRjdXQgaWNvbiI7dmFyIGM9cHJvbXB0KCJTZWxlY3QgYSB0YWIgY2xvYWtcbjEuIENhbnZhc1xuMi4gZS1oYWxscGFzc1xuMy4gTmV3IFRhYiIpOzE9PWM/KGwuaHJlZj0iaHR0cHM6Ly9oYXJyaXNvbmJ1cmcuaW5zdHJ1Y3R1cmUuY29tL2Zhdmljb24uaWNvIixkb2N1bWVudC50aXRsZT0iRGFzaGJvYXJkIik6Mj09Yz8obC5ocmVmPSJodHRwczovL2VkdXNwaXJlc29sdXRpb25zLm9yZy93cC1jb250ZW50L3VwbG9hZHMvMjAyMC8wOS9jcm9wcGVkLWZhdmljb24tMjcweDI3MC0xLTE1MHgxNTAucG5nIixkb2N1bWVudC50aXRsZT0iRGlnaXRhbCBIYWxsIFBhc3MgfCBlLUhhbGwgUGFzcyB8IEVkdXNwaXJlIFNvbHV0aW9ucyIpOjM9PWMmJihsLmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQkFBQUFBUUNBWUFBQUFmOC85aEFBQUEvVWxFUVZSNDJxMlMwUTNDTUF4RUdZRVJHSUZQMUZKMEpFWGlrdzFnQTlnQU5xQWJ3Q2FNd0FnZG9TTkFIcFZSRTdVSUlTS2QxRHErczMzTzZPOUgwbmd1ZHl6azY3bjhvMFY1eitVdk02MG5IOGtMK1cwZ05KQUcwT1J5aDE1eUpyY2o2UnRRYUtqMVYvVlFoZmIzTTJreWhJZ2NrcXRXb0R4QkppSFRha29jMk96aC9vZ1hJT29Da3dxVlowUUsrUTJFeElzR1FlYTNXQkNwM3dJV0pLbjlYMVk5czFkMDFvMmxBdUQyazBDOGN5bVRwbVlvNEJ0eXZDbDM3M3B3NnM2R0J4RE1SQVRUUXNSN1YyZ2l1SXdJZDdhQnRLT3ZIaEpDNlZaeWxmMnZrVFhGbmJpNmpmdXJWUzVDb2RHblk3TmprcjBKWnNjbkcrZXY1d2wxQnVrcWM0Q0I3Z0FBQUFCSlJVNUVya0pnZ2c9PSIsZG9jdW1lbnQudGl0bGU9Ik5ldyBUYWIiKTs=';document.body.appendChild(a);}())" 
          },
          {
            name: 'Invert Toggle',
            description: 'Invert page colours on any website (effective light/dark mode toggle).',
            code: "javascript:(function(){document.body.style.filter=document.body.style.filter?'':'invert(1)';})();"
          },
          {
            name: 'Dark Mode',
            description: '(Single use) an alternative method of toggling dark mode on any website.',
            code: "javascript:document.querySelectorAll('*').forEach(e=>e.setAttribute('style','background-color:#222;background-image:none;color:#'+(/^A|BU/.test(e.tagName)?'36c;text-decoration:underline;':'eee;')+e.getAttribute('style')))"
          },
          {
            name: 'Stats.js',
            description: 'Allows you to view your FPS, RAM, and MS.',
            code: "javascript:(function(){var script=document.createElement('script');script.onload=function(){var stats=new Stats();document.body.appendChild(stats.dom);requestAnimationFrame(function loop(){stats.update();requestAnimationFrame(loop)});};script.src='https://mrdoob.github.io/stats.js/build/stats.min.js';document.head.appendChild(script);})()"
          },
          {
            name: 'Edit any Page',
            description: 'Allows you to edit the text of any webpage.',
            code: 'javascript:console.log(document.body.contentEditable="true"==document.body.contentEditable?"false":"true");' 
          },
          {
            name: 'X-Ray Goggles',
            description: 'Allows you to view and edit the source code of any website (like a more powerful version of "Edit any page").',
            code: "javascript:(function () {var script=document.createElement('script');script.src='https://x-ray-goggles.mouse.org/webxray.js';script.className='webxray';script.setAttribute('data-lang','en-US');script.setAttribute('data-baseuri','https://x-ray-goggles.mouse.org');document.body.appendChild(script);}())"
          },
          {
            name: 'History Flooder',
            description: 'Floods your search history with the website you are currently on.',
            code: 'javascript:var num=prompt("History flood amount:");done=false;x=window.location.href;for (var i=1; i<=num; i++){history.pushState(0, 0, i==num?x:i.toString());if(i==num){done=true}}if(done===true){alert(%22History%20flood%20successful!%20%22+window.location.href+%22%20now%20appears%20in%20your%20history%20%22+num+(num==1?%22%20time.%22:%22%20times.%20(ajaxdev)%22))}'
          },
          {
            name: 'Piano',
            description: 'Adds a piano to the bottom of the website.',
            code: 'javascript:void(document.head.appendChild(document.createElement("script")).src="https://cdn.jsdelivr.net/gh/Krazete/bookmarklets/piano.min.js")'
          },
          {
            name: 'Developer Console',
            description: 'Adds all features of the developer console to whatever page your on.', 
            code: 'javascript:(function()%7B(function() %7Bvar x %3D document.createElement("script")%3Bx.src %3D "https%3A%2F%2Fcdn.jsdelivr.net%2Fgh%2FSnowLord7%2Fdevconsole%40master%2Fmain.js"%3Bx.onload %3D alert("Loaded Developer Console!")%3Bdocument.head.appendChild(x)%3B%7D)()%7D)()'
          },
          {
            name: "Minecraft Anywhere",
            description: "Explode and mine blocks on any website like Minecraft.",
            code: "javascript:(function(){window.mcbmRootURI='https://luphoria.com/MCanywhere/';window.mcbmScriptURI='mcbm.min.js';window.mcbmLang='eng';var s,ss=window.mcbmRootURI+'js/mcbm-load.min.js';s=document.createElement('script');s.src=ss;document.body.appendChild(s);})();z"
          },
          {
            name: "about:blank Embedder",
            description: "Embed any website in an about:blank iframe.",
            code: "javascript: (function () {var url = prompt('Paste the link you want to be embedded into an about:blank page.\n(INCLUDE https://)', 'https://example.com'); var urlObj = new window.URL(window.location.href); win = window.open(); win.document.body.style.margin = '0'; win.document.body.style.height = '100vh'; var iframe = win.document.createElement('iframe'); iframe.style.border = 'none'; iframe.style.width = '100%'; iframe.style.height = '100%'; iframe.style.margin = '0'; iframe.referrerpolicy = 'no-referrer'; iframe.allow = 'fullscreen'; iframe.src = url.toString(); win.document.body.appendChild(iframe); var script = win.document.createElement('script'); script.src = 'https://zatoga.pages.dev/js/main.min.js'; win.document.body.appendChild(script); })();"
          },
          {
            name: "Adblocker",
            description: "Blocks (most) ads on any website.",
            code: "javascript:(function(){    /* Ad-B-Gone: Bookmarklet that removes obnoxious ads from pages */    var selectors = [    /* By ID: */    '#sidebar-wrap', '#advert', '#xrail', '#middle-article-advert-container',    '#sponsored-recommendations', '#around-the-web', '#sponsored-recommendations',    '#taboola-content', '#taboola-below-taboola-native-thumbnails', '#inarticle_wrapper_div',    '#rc-row-container', '#ads', '#at-share-dock', '#at4-share', '#at4-follow', '#right-ads-rail',    'div#ad-interstitial', 'div#advert-article', 'div#ac-lre-player-ph',    /* By Class: */    '.ad', '.avert', '.avert__wrapper', '.middle-banner-ad', '.advertisement',    '.GoogleActiveViewClass', '.advert', '.cns-ads-stage', '.teads-inread', '.ad-banner',    '.ad-anchored', '.js_shelf_ads', '.ad-slot', '.antenna', '.xrail-content',    '.advertisement__leaderboard', '.ad-leaderboard', '.trc_rbox_outer', '.ks-recommended',    '.article-da', 'div.sponsored-stories-component', 'div.addthis-smartlayers',    'div.article-adsponsor', 'div.signin-prompt', 'div.article-bumper', 'div.video-placeholder',    'div.top-ad-container', 'div.header-ad', 'div.ad-unit', 'div.demo-block', 'div.OUTBRAIN',    'div.ob-widget', 'div.nwsrm-wrapper', 'div.announcementBar', 'div.partner-resources-block',    'div.arrow-down', 'div.m-ad', 'div.story-interrupt', 'div.taboola-recommended',    'div.ad-cluster-container', 'div.ctx-sidebar', 'div.incognito-modal', '.OUTBRAIN', '.subscribe-button',    '.ads9', '.leaderboards', '.GoogleActiveViewElement', '.mpu-container', '.ad-300x600', '.tf-ad-block',    '.sidebar-ads-holder-top', '.ads-one', '.FullPageModal__scroller',    '.content-ads-holder', '.widget-area', '.social-buttons', '.ac-player-ph',    /* Other: */    'script', 'iframe', 'video', 'aside#sponsored-recommendations', 'aside[role='banner']', 'aside',    'amp-ad', 'span[id^=ad_is_]', 'div[class*='indianapolis-optin']', 'div[id^=google_ads_iframe]',    'div[data-google-query-id]', 'section[data-response]', 'ins.adsbygoogle', 'div[data-google-query-id]',    'div[data-test-id='fullPageSignupModal']', 'div[data-test-id='giftWrap']' ];    for(let i in selectors) {        let nodesList = document.querySelectorAll(selectors[i]);        for(let i = 0; i < nodesList.length; i++) {            let el = nodesList[i];            if(el && el.parentNode)                el.parentNode.removeChild(el);        }    }})();"
          },
          {
            name: "Youtube Ad Skipper",
            description: "Skips ads on YouTube videos.",
            code: 'javascript:if(document.getElementsByClassName("video-ads")[0].innerHTML !==""){ var banner = false; for(var i = 0; i < document.getElementsByClassName("ytp-ad-overlay-close-button").length; i++){ document.getElementsByClassName("ytp-ad-overlay-close-button")[i].click(); banner = true;} if(banner === false){ document.getElementsByClassName("html5-main-video")[0].currentTime = document.getElementsByClassName("html5-main-video")[0].duration; document.getElementsByClassName("ytp-ad-skip-button")[0].click();} }void 0;'
          },
          {
            name: "Youtube Video Unblocker",
            description: "Unblocks YouTube videos that are blocked in your country/by your ISP. Works only on YouTube.",
            code: "javascript:(function () {if (window.location.toString().includes('www.youtube.com/watch?v%27)) { window.open(%27https://www.youtube-nocookie.com/embed/%27 + window.location.toString().split(%27=%27)[1]) }})()"
          },
          {
            name: "Youtube Scroller",
            description: "Keep the video in view while scrolling down the comments section on YouTube.",
            code: 'javascript:krazete:function videoAnchor(){var e,t,n,i,o,l,d,s,r;document.getElementsByClassName("miniplayer")[0].parentElement.active||(e=document.getElementById("movie_player"),t=document.getElementsByTagName("video")[0],n=document.getElementsByClassName("ytp-chrome-bottom")[0],i=document.getElementById("masthead-container").getBoundingClientRect(),s=document.querySelector("#player-container.ytd-watch-flexy").getBoundingClientRect(),e.removeAttribute("style"),o=e.getBoundingClientRect(),l=t.getBoundingClientRect(),s.bottom<i.height?(s=(document.getElementById("primary-inner")||document.getElementById("primary")).getBoundingClientRect(),d=320/l.width,s=(window.innerWidth-s.right)/l.width,r=(window.innerHeight-i.height)/l.height,e.style.position="fixed",e.style.right="0",e.style.top=i.height+"px",e.style.width=l.width+"px",e.style.height=l.height+"px",e.style.transformOrigin="right top",e.style.transform="scale("+Math.max(d,Math.min(s,r))+")",e.style.zIndex="1500",n.style.left="12px",n.style.width=l.width-24+"px",t.style.left=0):(n.style.left="12px",n.style.width=o.width-24+"px",t.style.left=(o.width-l.width)/2+"px"))}window.addEventListener("scroll",videoAnchor),window.addEventListener("resize",videoAnchor),(()=>{var i,o,t=document.createElement("div");t.textContent="▼",t.style.background="red",t.style.color="white",t.style.fontSize="24px",t.style.position="absolute",t.style.left="50%25",t.style.top="0",t.style.transform="translateX(-50%25)",t.style.display="none",t.style.borderRadius="0 0 8px 8px",t.style.zIndex="8000",t.style.cursor="pointer",document.body.appendChild(t),window.addEventListener("mouseup",function(e){var n;(e=e.target.closest("a"))&&/[?&]t=\d+s/.test(e.href)&&(i=window.scrollX,o=window.scrollY,t.style.display="block",requestAnimationFrame(function e(t){window.scrollTo(i,o),t-(n=void 0===n?t:n)<1&&requestAnimationFrame(e)}))}),t.addEventListener("click",function(){t.style.display="none",window.scrollTo(i,o)})})();'
          },
          {
            name: "Youtube Engagement",
            description: "Preview the likes-to-views ratio of YouTube videos.",
            code: 'javascript:krazete:function engage(){setTimeout(engage,1e3),Array.from(document.getElementsByTagName("ytd-thumbnail")).forEach(function(r){var e=r.getAttribute("value"),t=r.children[0].href;e!=t&&(r.setAttribute("value",t),r.style.borderBottom="",r.style.borderImage="",r.style.borderImageSlice="",r.style.paddingBottom="",r.style.marginTop="",(e=new XMLHttpRequest).open("GET",t,!0),e.onload=function(){var t=JSON.parse(this.responseText.match(/var ytInitialData = ({.+?});/)[1]);if(!t.contents.twoColumnWatchNextResults.results.results.contents[0].videoPrimaryInfoRenderer.viewCount.videoViewCountRenderer.isLive)try{var e=parseInt(t.contents.twoColumnWatchNextResults.results.results.contents[0].videoPrimaryInfoRenderer.videoActions.menuRenderer.topLevelButtons[0].segmentedLikeDislikeButtonViewModel.likeCountEntity.likeCountIfDislikedNumber.replace(/\D/g,"")),n=parseInt(t.contents.twoColumnWatchNextResults.results.results.contents[0].videoPrimaryInfoRenderer.viewCount.videoViewCountRenderer.viewCount.simpleText.replace(/\D/g,"")),o=n?100*Math.log(e+1)/Math.log(n+1):0;r.style.borderBottom="3px solid",r.style.borderImage="linear-gradient(to right, #008000 "+o+"%25, #404040"+o+"%25)",r.style.borderImageSlice="1",r.style.paddingBottom="2px",r.style.marginTop="-1px"}catch(e){console.log(t.contents.twoColumnWatchNextResults.results.results.contents[0].videoPrimaryInfoRenderer.title.runs[0].text)}},e.send())})}engage();'
          },
          {
            name: "Youtube Live Stamper",
            description: "Record timestamps for a video even during a livestream.",
            code: 'javascript:krazete:(()=>{function r(e,t){var n,a,o,i=location.search.split(/.+v=|&/)[1]||location.href.split(/\/live\/|\/shorts\/|\?|&/)[1];e.textContent=(n=t,a=Math.floor(n/3600),o=Math.floor(n/60)%2560,n=Math.floor(n)%2560,(a?a+":"+String(o).padStart(2,0):o)+":"+String(n).padStart(2,0)),e.dataset.time=t,e.href="https://youtu.be/"+i+"?t="+t}function e(e){var t;e.target.dataset.time?(e.preventDefault(),document.querySelector("video").currentTime=e.target.dataset.time):e.target.dataset.increment&&(e.preventDefault(),r(t=e.target.parentElement.children[2],parseInt(t.dataset.time)+parseInt(e.target.dataset.increment)))}function i(e){var t=document.createElement("li"),n=document.createElement("span"),a=document.createElement("span"),o=document.createElement("a"),i=document.createElement("input");return n.textContent="➖",n.dataset.increment=-1,a.textContent="➕",a.dataset.increment=1,r(o,e),t.appendChild(n),t.appendChild(a),t.appendChild(o),t.appendChild(i),d.appendChild(t),i}function a(){v=!0,C.textContent="Copy List"}function t(e){return e.preventDefault(),e.returnValue="Close timestamp tool?",e.returnValue}var n,o,d,l,c,p,u,s,m,h,f,v,C,y;document.querySelector("#ytls-pane")||(n=document.createElement("div"),o=document.createElement("span"),d=document.createElement("ul"),l=document.createElement("li"),c=document.createElement("a"),u=document.createElement("input"),s=document.createElement("textarea"),m=document.createElement("div"),h=document.createElement("button"),f=document.createElement("button"),v=!0,C=document.createElement("button"),y=document.createElement("style"),n.id="ytls-pane",o.textContent="×",function e(){try{var t=Math.floor(document.querySelector("video").duration);r(c,t)}catch(e){}p=requestAnimationFrame(e)}(),u.disabled=!0,u.value="End of Video",s.id="ytls-box",m.id="ytls-buttons",h.textContent="Import List",f.textContent="Add Timestamp",C.textContent="Copy List",y.textContent=` #ytls-pane { background: rgba(0,0,0,.5); text-align: right; position: fixed; bottom: 0; padding: 0 5px; opacity: .5; z-index: 5000; } #ytls-pane:hover { opacity: 1; } #ytls-pane span { cursor: pointer; } #ytls-pane ul { list-style: none; } #ytls-pane span, #ytls-pane a, #ytls-pane input { background: none; color: white; font-family: inherit; font-size: initial; text-decoration: none; border: none; outline: none; } #ytls-box { font-family: monospace; width: 100%25; display: block; padding: 0; border: none; outline: none; resize: none; } #ytls-buttons { display: flex; } #ytls-buttons button { background: transparent; color: white; font-size: 12px; flex: auto; padding: 2px; border: 1px solid white; } `,o.addEventListener("click",function(){confirm("Close timestamp tool?")&&(n.remove(),cancelAnimationFrame(p),window.removeEventListener("beforeunload",t))}),d.addEventListener("click",e),d.addEventListener("touchstart",e),h.addEventListener("click",function(){var e=s.value.split("\n");d.textContent="";for(var t=0;t<e.length;t++){var n=e[t].trim(),a=n.split(/\s+/,1)[0],o=(o=(o=a).split(":").map(e=>parseInt(e))).length<3?60*o[0]+o[1]:3600*o[0]+60*o[1]+o[2],n=n.slice(a.length+1);i(o).value=n}d.appendChild(l)}),f.addEventListener("click",function(){var e=i(Math.max(0,Math.floor(document.querySelector("video").currentTime-5)));d.appendChild(l),e.focus()}),C.addEventListener("click",function(){var e="";if(v){v=!1,C.textContent="Copy Links",setTimeout(a,500);for(var t=0;t<d.children.length-1;t++)e+=(0<t?"\n":"")+((n=d.children[t].children[2].textContent)+" "+d.children[t].children[3].value).trim()}else{a();for(t=0;t<d.children.length-1;t++){var n=d.children[t].children[2].href;e+=(0<t?"\n":"")+(d.children[t].children[3].value+" "+n).trim()}}s.value=e,s.select(),document.execCommand("copy")}),window.addEventListener("beforeunload",t),n.appendChild(o),l.appendChild(c),l.appendChild(u),d.appendChild(l),n.appendChild(d),n.appendChild(s),m.appendChild(h),m.appendChild(f),m.appendChild(C),n.appendChild(m),n.appendChild(y),document.body.appendChild(n),s.focus())})();'
          },
          {
            name: "Youtube (Video) Speed",
            description: "Speed up (YouTube) videos even more. Also has a slider to dim video brightness. Works on other video sites too.",
            code: 'javascript:krazete:function initDash(){var e,t=document.createElement("div"),n=(t.style.position="fixed",t.style.right="0",t.style.bottom="0",t.style.zIndex="4999",document.createElement("div")),n=(n.textContent="❌",n.addEventListener("click",function(){t.remove()}),t.appendChild(n),document.createElement("input")),i=(n.type="range",n.min=0,n.max=1,n.step=.1,n.value=.7,n.addEventListener("input",function(){document.getElementsByTagName("video")[0].style.filter="brightness("+this.value+")"}),t.appendChild(n),document.createElement("div"));for(e of[1,2,3,5,10]){var a=document.createElement("button");a.value=e,a.textContent="x"+e,i.appendChild(a)}i.addEventListener("click",function(e){document.getElementsByTagName("video")[0].playbackRate=parseInt(e.target.value)}),t.appendChild(i),document.body.appendChild(t)}initDash();'
          },
          {
            name: "Youtube Thumbnail",
            description: "Get the maximum resolution thumbnail of the current video.",
            code: 'javascript:krazete:open("https://i.ytimg.com/vi/"+location.search.match(/v=([^&]+)/)[1]+"/maxresdefault.jpg");'
          },
          {
            name: "Youtube Glow",
            description: "An alternative to YouTube's ambient mode - toggle a simple blur glow effect behind videos.",
            code: 'javascript:krazete:var fograf;(()=>{var i,o=document.getElementById("videofog");function r(){var e=document.querySelector("ytd-watch-flexy video")||document.querySelector("video"),t=e.getBoundingClientRect();o.width=64,o.height=64*t.height/t.width,o.style.width=t.width+"px",o.style.height=t.height+"px",i.drawImage(e,0,0,o.width,o.height),fograf=requestAnimationFrame(r)}o?(o.remove(),cancelAnimationFrame(fograf)):((o=document.createElement("canvas")).id="videofog",o.style.position="absolute",o.style.left="50%25",o.style.transform="translate(-50%25)",o.style.filter="blur(100px) contrast(1.5)",o.style.mixBlendMode="lighten",i=o.getContext("2d"),function t(){try{var e=document.querySelector("ytd-watch-flexy ytd-player #container");e.insertBefore(o,e.firstChild),r()}catch(e){requestAnimationFrame(t)}}())})();'
          },
          {
            name: "JS Calculator",
            description: "A simple calculator that can be used on any website.",
            code: "javascript:eval('function calc(){_o=prompt(_t,_z);if(_o!=\'\'&&_o!=null&&_o.toUpperCase()==_o.toLowerCase())_z=eval(_o);}');_t='JAVASCRIPTER.NET Calculator - Input the expression to be calculated:';_z='';calc();while(_o!=''&&_o!=null&&_o.toUpperCase()==_o.toLowerCase())calc()"
          },
          {
            name: "3D Layers Viewer",
            description: "View a webpage in 3D layers.",
            code: 'javascript:krazete:(()=>{var d={menu:document.createElement("div"),limit:document.createElement("input"),gap:document.createElement("input"),sag:document.createElement("input"),fov:document.createElement("input"),flo:document.createElement("input"),off:document.createElement("input"),non:document.createElement("input"),end:document.createElement("input"),tgl:document.createElement("input"),cssStatic:document.createElement("style"),cssDynamic:document.createElement("style"),orientation:{yaw:0,pitch:0,roll:0},mouseMove:function(e){d.orientation.yaw=180*-Math.cos(Math.PI*e.clientX/innerWidth)*d.limit.value,d.orientation.pitch=180*Math.cos(Math.PI*e.clientY/innerHeight)*d.limit.value,d.updateBody()},gyroMove:function(e){innerWidth>innerHeight?(d.orientation.yaw=-(e.alpha+e.beta),d.orientation.pitch=e.gamma-90*Math.sign(90-Math.abs(e.beta))):(d.orientation.yaw=-(e.alpha+e.gamma),d.orientation.pitch=e.beta-90),d.updateBody()},updateOrigin:function(e){document.body.style.transformOrigin=innerWidth/2+pageXOffset+"px "+(innerHeight/2+pageYOffset)+"px"},updateBody:function(){document.body.style.transform="perspective("+Math.pow(2,d.fov.value)+"px) translateZ(-"+d.gap.value+"px) rotateX("+d.orientation.pitch+"deg) rotateY("+d.orientation.yaw+"deg)"},updateCSS:function(){if(d.non.checked)d.cssDynamic.textContent="";else if(d.off.checked)d.cssDynamic.textContent="* { transform-style: preserve-3d; }";else{for(var e=0;document.querySelector("body"+" > *".repeat(e));e++);var t=d.gap.value/e,n=-Math.PI*d.sag.value/e;d.cssDynamic.textContent=` * { transform: translateZ(${t}px) rotateX(${n}rad); transform-style: preserve-3d; transition: transform 1s; outline: 1px solid rgba(0, 0, 0, 0.0625); ${d.flo.checked?"overflow: visible !important;":""} } *:hover { transform: translateZ(${2*t}px) rotateX(${2*n}rad); ${d.flo.checked?"":"overflow: visible;"} } `}},toggle:function(){"active"==d.menu.className?d.menu.removeAttribute("class"):d.menu.className="active"},quit:function(){window.removeEventListener("deviceorientation",d.gyroMove),window.removeEventListener("mousemove",d.mouseMove),window.removeEventListener("scroll",d.updateOrigin),window.addEventListener("resize",d.updateOrigin),d.menu.remove(),d.cssStatic.remove(),d.cssDynamic.remove(),document.body.removeAttribute("style")},newRange:function(e,t,n,o,i,a,r){d.menu.appendChild(e),e.type="range",e.min=n,e.max=i,e.step=o,e.value=a,e.addEventListener("input",r),d.menu.appendChild(document.createElement("span")).textContent=t,d.menu.appendChild(document.createElement("br"))},newCheckbox:function(e,t,n){d.menu.appendChild(e),e.type="checkbox",e.addEventListener("click",n),d.menu.appendChild(document.createElement("span")).textContent=t,d.menu.appendChild(document.createElement("br"))},newButton:function(e,t,n){d.menu.appendChild(e),e.type="button",e.value=t,e.addEventListener("click",n)},init:function(){document.body.parentNode.appendChild(d.menu).id="tri-menu",d.newRange(d.limit,"limit",0,.03125,1,.125,d.updateBody),d.newRange(d.gap,"gap / distance",0,32,512,128,function(){d.updateCSS(),d.updateBody()}),d.newRange(d.sag,"sag",-.25,.03125,.25,0,d.updateCSS),d.newRange(d.fov,"field of view",7,1,13,10,d.updateBody),d.newCheckbox(d.flo,"force overflow",d.updateCSS),d.flo.setAttribute("checked",""),d.newCheckbox(d.off,"flatten layers",d.updateCSS),d.newCheckbox(d.non,"flatten everything",d.updateCSS),d.newButton(d.end,"Quit",d.quit),d.newButton(d.tgl,"≡",d.toggle),d.tgl.id="tri-toggle",d.menu.appendChild(d.cssStatic).textContent=` html, body { transition-property: none; height: 100%25; width: 100%25; } html, html:hover, #tri-menu, #tri-menu > *, #tri-menu > *:hover { transform: none; outline: none; overflow: auto !important; float: none; } #tri-menu { position: fixed; top: 0; left: 0; background: rgba(0, 0, 0, 0.5); color: white; border: 1px solid rgba(255, 255, 255, 0.5);; border-radius: 0 0 16px 0; padding: 8px; transform: translate(-100%25, -100%25) translate(32px, 32px); } #tri-menu.active { transform: none; } #tri-toggle { position: absolute; bottom: 0; right: 0; height: 32px; width: 32px; background: transparent; color: white; border: none; cursor: pointer; } #tri-menu.active > #tri-toggle { background: white; color: black; border-radius: 8px 0 0 0; } `,d.menu.appendChild(d.cssDynamic),d.updateCSS(),window.addEventListener("deviceorientation",d.gyroMove),window.addEventListener("mousemove",d.mouseMove),window.addEventListener("scroll",d.updateOrigin),window.addEventListener("resize",d.updateOrigin),window.scrollBy(0,1)}};d.init()})();'
          },
          {
            name: "MouseLight",
            description: "Simulate a flashlight with your cursor. Works best on websites with deeply nested HTML elements.",
            code: 'javascript:krazete:var style=document.createElement("style"),canvas=(document.body.appendChild(style),document.createElement("canvas")),context=(canvas.id="canvas",document.body.appendChild(canvas),canvas.getContext("2d"));function outlineBounds(){context.clearRect(0,0,window.innerWidth,window.innerHeight),context.beginPath(),Array.from(document.querySelectorAll("*")).map(function(t){return t.getBoundingClientRect()}).filter(function(t){var n=window.scrollY<t.bottom||t.top<window.scrollY+window.innerHeight,t=window.scrollX<t.right||t.left<window.scrollX+window.innerWidth;return n&&t}).forEach(function(t){context.rect(t.left,t.top,t.right-t.left,t.bottom-t.top)}),context.stroke()}function fillBounds(){context.clearRect(0,0,window.innerWidth,window.innerHeight),context.fillStyle="#00000011",Array.from(document.querySelectorAll("*")).map(function(t){return t.getBoundingClientRect()}).filter(function(t){var n=window.scrollY<t.bottom||t.top<window.scrollY+window.innerHeight,t=window.scrollX<t.right||t.left<window.scrollX+window.innerWidth;return n&&t}).forEach(function(t){context.fillRect(t.left,t.top,t.right-t.left,t.bottom-t.top)})}function resizeCanvas(){style.textContent=`#canvas { position: fixed; left: 0; top: 0; width: 100%25; height: 100%25; z-index: 9999; pointer-events: none; }`,canvas.width=window.innerWidth,canvas.height=window.innerHeight,fillBounds()}resizeCanvas(),window.addEventListener("scroll",fillBounds),window.addEventListener("resize",resizeCanvas);var pixelSize=8,halfPixel=Math.floor(pixelSize/2);function drawPixel(t,n,e,i,o,r){context.fillStyle="rgba("+[e,i,o,r].join(", ")+")",context.fillRect(t-halfPixel,n-halfPixel,pixelSize,pixelSize)}function distanceSquared(t,n){var e=n.x-t.x,n=n.y-t.y;return e*e+n*n}function main(t){fillBounds();var n=context.getImageData(0,0,context.canvas.width,context.canvas.height).data;context.clearRect(0,0,context.canvas.width,context.canvas.height);for(var e=0;e<context.canvas.width;e+=pixelSize)for(var i=0;i<context.canvas.height;i+=pixelSize){var o={x:e,y:i},r=1/distanceSquared(o,t),a=0,l=255,c=255,o=1/distanceSquared(o,{x:window.innerWidth-t.x,y:window.innerHeight-t.y}),d=255,w=0,s=0,h=r+o,a=Math.floor((a*r+d*o)/h),d=Math.floor((l*r+w*o)/h),l=Math.floor((c*r+s*o)/h);1e-6<h&&(w=256*h*(256-n[4*(e+i*window.innerWidth)+3]),drawPixel(e,i,Math.floor(a*w),Math.floor(d*w),Math.floor(l*w),1-w))}}window.addEventListener("mousemove",main);'
          },
          {
            name: "Ultimate TicTacToe",
            description: "Play a game of Ultimate TicTacToe on any website.",
            code: 'javascript:krazete:var turn=Math.random()<.5?0:1,unit=100/11,menu=document.createElement("div"),exit=(menu.style.position="fixed",menu.style.top="50%25",menu.style.left="50%25",menu.style.height=9*unit+"vmin",menu.style.width=9*unit+"vmin",menu.style.transform="translate(-50%25,-50%25)",menu.style.zIndex=9999,document.createElement("a")),board=(exit.style="background:white;position:absolute;left:100%25;cursor:pointer",exit.textContent="exit",exit.addEventListener("click",function(){menu.remove()}),menu.appendChild(exit),document.body.appendChild(menu),document.createElement("div"));board.style.background="rgba(255,255,255,0.9)",board.style.position="absolute",board.style.top=0,board.style.left=0,board.style.height=9*unit+"vmin",board.style.width=9*unit+"vmin",board.mark=null,menu.appendChild(board),BOXES=[],boxes=[[],[],[],[],[],[],[],[],[]];for(var i=0;i<3;i++)for(var j=0;j<3;j++){var BOX=document.createElement("div");BOX.style.position="absolute",BOX.style.top=100*i/3+"%25",BOX.style.left=100*j/3+"%25",BOX.style.height=100/3+"%25",BOX.style.width=100/3+"%25",BOX.mark=null;for(var k=0;k<3;k++)for(var l=0;l<3;l++){var box=document.createElement("div");box.addEventListener("mouseover",onmouseover),box.addEventListener("mouseout",onmouseout),box.addEventListener("click",pick),box.style.position="absolute",box.style.top=100*k/3+"%25",box.style.left=100*l/3+"%25",box.style.height=100/3+"%25",box.style.width=100/3+"%25",box.macro=3*i+j,box.micro=3*k+l,box.mark=null,boxes[3*i+j].push(box),box.macro%252==0?box.style.boxShadow="0 0 1vmin black inset":box.style.boxShadow="0 0 1vmin gray inset",BOX.appendChild(box)}BOXES.push(BOX),board.appendChild(BOX)}function check(e){var t=0;null!=e[0].mark&&(e[0].mark==e[1].mark&&e[1].mark==e[2].mark||e[0].mark==e[3].mark&&e[3].mark==e[6].mark)&&(t=1),null!=e[4].mark&&(e[3].mark==e[4].mark&&e[4].mark==e[5].mark||e[1].mark==e[4].mark&&e[4].mark==e[7].mark||e[0].mark==e[4].mark&&e[4].mark==e[8].mark||e[2].mark==e[4].mark&&e[4].mark==e[6].mark)&&(t=1),(t=null!=e[8].mark&&(e[6].mark==e[7].mark&&e[7].mark==e[8].mark||e[2].mark==e[5].mark&&e[5].mark==e[8].mark)?1:t)?marker(e[0].parentNode):null!=e[0].mark&&null!=e[1].mark&&null!=e[2].mark&&null!=e[3].mark&&null!=e[4].mark&&null!=e[5].mark&&null!=e[6].mark&&null!=e[7].mark&&null!=e[8].mark&&draw(e[0].parentNode)}function draw(e){e.mark=2,disable(e),e.style.pointerEvents="none"}function marker(e){if(0==turn){for(var t=document.createElement("div"),r=(t.style.boxSizing="border-box",t.style.position="absolute",t.style.top="10%25",t.style.left="10%25",t.style.height="80%25",t.style.width="80%25",0),o=0;o<9;o++)if(e==BOXES[o]){r=1;break}t.style.border=unit*(e==board?9:r?3:1)/5+"vmin solid black",t.style.borderRadius="50%25",e.appendChild(t)}else{t=document.createElement("div"),t=(t.style.boxSizing="border-box",t.style.background="black",t.style.position="absolute",t.style.top="10%25",t.style.left="40%25",t.style.height="80%25",t.style.width="20%25",t.style.transform="rotate(45deg)",e.appendChild(t),t.cloneNode());t.style.transform="rotate(-45deg)",e.appendChild(t)}e.mark=turn,disable(e),e.style.pointerEvents="none"}function pick(){var e=this;if(marker(e),check(boxes[e.macro]),check(BOXES),turn=0<turn?0:1,null==BOXES[e.micro].mark){for(i=0;i<9;i++)for(var t=0;t<9;t++)disable(boxes[i][t]);for(i=0;i<9;i++)null==board.mark&&enable(boxes[e.micro][i])}else for(i=0;i<9;i++)for(t=0;t<9;t++)null==board.mark&&enable(boxes[i][t]);disable(e)}function disable(e){e.style.background="rgba(0,0,0,0.25)",e.removeEventListener("mouseover",onmouseover),e.removeEventListener("mouseout",onmouseout),e.removeEventListener("click",pick)}function enable(e){null==e.mark&&(e.style.background="transparent"),e.addEventListener("mouseover",onmouseover),e.addEventListener("mouseout",onmouseout),e.addEventListener("click",pick)}function onmouseover(){this.style.background="rgba(0,0,0,0.25)"}function onmouseout(){this.style.background="transparent"}'
          },
          {
            name: "Picture in Picture",
            description: "Toggle picture-in-picture mode for the first video on the page.",
            code: 'javascript:krazete:var v,pop,videos=Array.from(document.getElementsByTagName("video")),video=videos[0];for(v of videos)if(!v.paused){video=v;break}function popout(){video.removeAttribute("disablePictureInPicture"),video.requestPictureInPicture()}function popin(){document.exitPictureInPicture()}video.addEventListener("enterpictureinpicture",e=>pop=popin),video.addEventListener("leavepictureinpicture",e=>pop=popout),(pop=pop||popout)();'
          },
          {
            name: "Invert Media",
            description: "Invert image and video elements on any site.",
            code: 'javascript:krazete:var invertimg;void 0===invertimg?((invertimg=document.createElement("style")).textContent="img,video,embed,object{filter:invert(100%25)}",document.body.appendChild(invertimg)):(invertimg.remove(),invertimg=void 0);'
          },
          {
            name: "Censor Media",
            description: "Pixelates all visible image and video elements. Uncensors on hover. (buggy)",
            code: 'javascript:krazete:var censorStyle,sensed,censors,af,quality=1.5;function onScreen(e){return 0<e.right&&0<e.bottom&&e.left<innerWidth&&e.top<innerHeight}function copyStyle(e,t,n){var r,o=getComputedStyle(e),e=Object.keys(o);for(r of e=n?["width","height"]:e)t.style[r]=o[r]}function updateCensor(e,t){var n,r=e.getBoundingClientRect();if(onScreen(r))return n=Math.log2(Math.max(r.width*r.height,2)),t.width=r.width*quality/n,t.height=r.height*quality/n,af%25120==0&&copyStyle(e,t,!0),t.getContext("2d").drawImage(e,0,0,t.width,t.height),e.parentElement.classList.add("censor-parent"),t}function createCensor(e){var t,n,r=e.getBoundingClientRect();if(onScreen(r))return(t=document.createElement("canvas")).className="censor",n=Math.log2(Math.max(r.width*r.height,2)),t.width=r.width*quality/n,t.height=r.height*quality/n,copyStyle(e,t),t.getContext("2d").drawImage(e,0,0,t.width,t.height),e.parentElement.insertBefore(t,e),e.parentElement.classList.add("censor-parent"),t}function sense(){var e;for(e of document.querySelectorAll("img,video")){var t=sensed.indexOf(e);0<=t?"VIDEO"!=e.tagName||e.paused||updateCensor(e,censors[t]):("VIDEO"==e.tagName||e.complete)&&(t=createCensor(e))&&(censors.push(t),sensed.push(e))}af=requestAnimationFrame(sense)}if(af){cancelAnimationFrame(af),af=0;for(var c of censors)c.remove();for(var e of sensed)e.parentElement.classList.remove("censor-parent");censorStyle.remove()}else(censorStyle=document.createElement("style")).textContent=`.censor { opacity: 1 !important; image-rendering: pixelated !important; } .censor + img { display: none !important; } .censor + video { visibility: hidden !important; } .censor-parent:hover .censor { display: none !important; } .censor-parent:hover .censor + img { display: unset !important; } .censor-parent:hover .censor + video { visibility: visible !important; }`,document.body.appendChild(censorStyle),sensed=[],censors=[],sense();'
          },
          {
            name: "Delete Tool",
            description: "Delete selected elements. Useful for removing ads and paywalls.",
            code: 'javascript:krazete:(()=>{var a,m,c,w;function h(e){return e.preventDefault(),e.touches?{x:(e.touches[0]||e.changedTouches[0]).clientX+window.scrollX,y:(e.touches[0]||e.changedTouches[0]).clientY+window.scrollY}:{x:e.clientX+window.scrollX,y:e.clientY+window.scrollY}}function u(e){window.removeEventListener("mousemove",v),window.removeEventListener("touchmove",v),window.removeEventListener("mouseup",u),window.removeEventListener("touchend",u),w=h(e),document.body.style.pointerEvents="",a.remove(),m.remove();for(var e=Math.min(c.x,w.x),t=Math.max(c.x,w.x),n=Math.min(c.y,w.y),o=Math.max(c.y,w.y),s=Math.max(1,(t-e)/10),d=Math.max(1,(o-n)/10),i=[],r=e;r<=t;r+=s)for(var l=n;l<=o;l+=d)i.push(document.elementsFromPoint(r-window.scrollX,l-window.scrollY));i.sort((e,t)=>e.length-t.length),e=i[0].filter(t=>t!=m&&i.every(e=>e.includes(t))),console.log(e),e[0].remove()}function v(e){var e=h(e);e=e,m.style.left=Math.min(c.x,e.x)+"px",m.style.top=Math.min(c.y,e.y)+"px",m.style.width=Math.abs(e.x-c.x)+"px",m.style.height=Math.abs(e.y-c.y)+"px"}function t(e){window.removeEventListener("mousedown",t),window.removeEventListener("touchstart",t),window.addEventListener("mousemove",v),window.addEventListener("touchmove",v,{passive:!1}),window.addEventListener("mouseup",u),window.addEventListener("touchend",u),c=h(e),e="r"+parseInt(1e13*Math.random()),document.body.style.pointerEvents="none",(a=document.createElement("style")).textContent="."+e+"::after{content:\'\\00D7\';position:absolute;left:50%25;top:50%25;transform:translate(-50%25,-50%25);color:red;font-size:15em;}",document.body.appendChild(a),(m=document.createElement("div")).className=e,m.style.position="absolute",m.style.left=c.x+"px",m.style.top=c.y+"px",m.style.width=0,m.style.height=0,m.style.outline="3px dashed red",m.style.boxShadow="inset 0 0 30px 3px pink",m.style.mixBlendMode="difference",m.style.overflow="hidden",m.style.zIndex=1e13,document.body.appendChild(m)}document.body.style.pointerEvents="none",window.addEventListener("mousedown",t),window.addEventListener("touchstart",t)})();'
          },
          {
            name: "Invert Tool",
            description: "Inverts selected elements.",
            code: 'javascript:krazete:(()=>{var a,h,m,v;function u(e){h.remove(),a.remove(),e.style.filter="invert(1)"==e.style.filter?"":"invert(1)"}function w(e){return e.touches?("touchmove"==e.type&&e.preventDefault(),e.touches[0]||e.changedTouches[0]):e}function p(e){window.removeEventListener("mousemove",y),window.removeEventListener("touchmove",y),window.removeEventListener("mouseup",p),window.removeEventListener("touchend",p),v=w(e);for(var e=u,t=Math.min(m.clientX,v.clientX),n=Math.max(m.clientX,v.clientX),i=Math.min(m.clientY,v.clientY),o=Math.max(m.clientY,v.clientY),l=Math.max(1,(n-t)/10),s=Math.max(1,(o-i)/10),d=[],c=t;c<=n;c+=l)for(var r=i;r<=o;r+=s)d.push(document.elementsFromPoint(c,r));d.sort((e,t)=>e.length-t.length),t=d[0].filter(t=>t!=h&&t!=a&&d.every(e=>e.includes(t))),console.log(t),e(t[0])}function y(e){e=w(e);h.style.left=Math.min(m.clientX,e.clientX)+"px",h.style.top=Math.min(m.clientY,e.clientY)+"px",h.style.width=Math.abs(e.clientX-m.clientX)+"px",h.style.height=Math.abs(e.clientY-m.clientY)+"px"}function t(e){window.removeEventListener("mousedown",t),window.removeEventListener("touchstart",t),window.addEventListener("mousemove",y),window.addEventListener("touchmove",y,{passive:!1}),window.addEventListener("mouseup",p),window.addEventListener("touchend",p),m=w(e),(h=document.createElement("div")).style.position="relative",h.style.left=m.clientX+"px",h.style.top=m.clientY+"px",h.style.width=0,h.style.height=0,h.style.outline="3px dashed black",h.style.boxShadow="inset 0 0 30px 3px white",h.style.mixBlendMode="difference",a.appendChild(h)}(a=document.createElement("div")).style.position="fixed",a.style.left=0,a.style.top=0,a.style.width="100%25",a.style.height="100%25",a.style.zIndex=1e13,document.body.appendChild(a),window.addEventListener("mousedown",t),window.addEventListener("touchstart",t)})();'
          }
          
        ]
      };
    },
    methods: {
      onDragStart(event, code) {
        event.dataTransfer.setData('text/plain', code);
      }
    }
  };
  </script>
  
  <style>
  .bookmarklets-view {
    padding: 20px;
  }
  </style>